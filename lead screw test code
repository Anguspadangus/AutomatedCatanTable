# -*- coding: utf-8 -*-
"""
Created on Thu Jan 25 20:40:20 2024

@author: Owen Porpora
"""

import RPi.GPIO as gpio
import time

# Define your pin assignments
MOTOR_DIRECTION_PIN = 20  # DIR
MOTOR_STEP_PIN = 21  # STP

def setup_gpio():
    gpio.setmode(gpio.BCM)
    gpio.setup(MOTOR_DIRECTION_PIN, gpio.OUT)  # Direction
    gpio.setup(MOTOR_STEP_PIN, gpio.OUT)       # Step

def set_direction(direction):
    if direction == 'left':
        gpio.output(MOTOR_DIRECTION_PIN, True)
    elif direction == 'right':
        gpio.output(MOTOR_DIRECTION_PIN, False)

def step_motor(steps, wait_time=0.005):
    step_counter = 0
    while step_counter < steps:
        gpio.output(MOTOR_STEP_PIN, True)
        gpio.output(MOTOR_STEP_PIN, False)
        step_counter += 1
        time.sleep(wait_time)

def cleanup_gpio():
    gpio.cleanup()

def main():
    try:
        direction = input("Enter direction (left/right): ").lower()
        steps = int(input("Enter the number of steps: "))
        
        setup_gpio()
        set_direction(direction)
        step_motor(steps)
        
    except ValueError:
        print("Invalid input. Please enter a valid number of steps.")
    except KeyboardInterrupt:
        print("Program interrupted by the user.")
    finally:
        cleanup_gpio()

if __name__ == "__main__":
    main()
